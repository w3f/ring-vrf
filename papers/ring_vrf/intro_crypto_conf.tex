\section{Introduction}

We introduce a novel cryptographic primitive called \emph{a ring verifiable random function (ring VRF)}. Ring VRF  operates in a manner akin to both VRF \cite{vrf_micali}  and ring signatures \cite{ring_accountable,ring_efficient,ring_linkable,ring_noRO,ring_sublinear}, leveraging the properties of uniqueness, pseudorandomness, and anonymity. In ring VRF, a user can generate a ring VRF output, which is a \emph{unique} pseudorandom number, with their key and  input  similar to VRF. They also sign the input and any message (e.g., auxiliary data) with a set of public keys  (ring) including their key, similar to the ring signatures. The ring signature assures that the ring VRF output is the unique output of the input generated with one of the public keys and the same key signs also the message. The verification process does not reveal the signer's key except that their key is in the public key set.



The distinctive properties of ring VRF such as pseudorandomness, anonymity and uniqueness offer  an efficient alternative for anonymous access control systems. Imagine an identity system where a user registers with their public key. Assuming that the system maintains a fixed input for a given service (e.g., urls) and provides a public commitment of the registered public keys, a registered user  can create a ring VRF output using the fixed input and their key, which serves as their pseudonym.  The user can then use this pseudonym as an identity while accessing a service provided by the system. At the same time, they can prove that their pseudonyms  are  legitimate  all without revealing their true identity. Namely, they generate a ring VRF signature which shows that their pseudonym is associated with one of the registered users. In this way, the identity system protects the user's  privacy. Moreover, the  system is protected against the Sybil behaviour, as the ring VRF protocol ensures that a user can produce only one pseudonym per input. This protection enables the system to ban certain pseudonyms in cases of abusive behaviours. Thus, the abusive user loses the access since they cannot generate  another legitimate pseudonym for this particular service.
In current anonymous systems, user accountability is primarily addressed through two main approaches: (1) allowing users to authenticate for a fixed duration \cite{limited_authentication1,limited_authentication2,limited_authentication3}, and (2) incorporating mechanisms for privacy revocation administered by a central authority \cite{revocation1,revocation2,revocation3,revocation4}, or through privacy revocation using anonymous committees \cite{anonymous-committee1,anonymous-committee2}.
In contrast, Ring VRF offers a straightforward, efficient and succinct solution for user accountability when compared to existing methods as it neither imposes limitations on user behaviours nor necessitates the involvement of central authorities or anonymous committees to revoke the privacy of a malicious user.
In addition to facilitate anonymous authentication, ring VRF  serves as a potent tool for the concept of proof-of-personhood (PoP) \cite{pop2008,pop2017,pop2020} to establish a connection between the physical entities and virtual identities by preserving the accountability and anonymity of the entity. 
%In this context, an individual can physically enrol in a designated system (e.g., an issuer responsible for issuing identity cards) with a ring VRF key. Then, they present their ring VRF outputs as a virtual identity to another system, with the ring VRF signature serving as verifiable evidence of their physical existence. This process maintains their anonymity across different contexts since each ring VRF output of a corresponding system is unlinkable. 


Unique ring signature (URS) schemes \cite{URCframework} aim to address similar challenges as ring VRF in the context of anonymous identity applications. Both generate a unique identifier within the ring signature for each input, which corresponds to the ring VRF output in our case. Unlike ring VRF, where a party can sign any message with a ring VRF signature, unique ring signature schemes do not include the capability to sign such messages. Therefore, leveraging these identifiers for practical authentication, such as in a TLS session, is not straightforward. 
Beyond this, we demand from a ring VRF output  to be a pseudorandom even if the signer's key is maliciously generated. This property distinguishes it from unique ring signatures. 
Although this property may not find immediate use in the identity applications we mentioned, it holds critical significance in applications that grant privileges to parties based on specific criteria associated with their ring VRF output, such as leader elections or lotteries. 
For instance, blockchain protocols often select leaders to produce a block  based on the VRF output of a party, with parties having a VRF output below a certain threshold being chosen as leaders \cite{praos,genesis}. Since ring VRF provides the same pseudorandomness property required in these leader election mechanisms, a ring VRF scheme  can potentially replace VRF in these protocols to provide also anonymity to leaders even after they produce their blocks. 
We remark that VRF cannot provide this level of anonymity, as verifying the correctness of the VRF output  of a leader, which is necessary to verify the block of the leader, requires knowledge of the leader's public key.



We design two efficient ring VRF protocols that can be applied to real-world scenarios.
In simple terms,  our ring VRF signatures has components dedicated to verifying the output and confirming the key membership. Some scenarios require the generation of multiple ring VRF signatures for different inputs for \emph{the same ring}. In these scenarios, since the ring does not change only the output changes, an optimized approach to generate a new signature given another signature generated for the same ring would be as follows:  generate a new component only for the aspects directly associated with the correctness of the ring VRF output and  rerandomize the relevant component of a prior signature indicating the existence of the signing key in the ring. This optimized solution at the same time should preserve both verifiability and anonymity of the optimized signature.
To this end, we introduce a  new notion called \emph{zero-knowledge continuations}. It provides a way to efficiently prove a statement with a simple transformation of an existing proof of the same statement. After this transformation the new proof remains unlinkable to the other proofs. 

In short, our contributions in this paper are as follows:
 \begin{itemize}
 	\item We formally define the security of a ring VRF in the universal composability (UC) model. For this, we construct a functionality $ \fgvrf $ and verify the security properties that $ \fgvrf $ provides.
 	
 	\item We introduce a new notion called zero-knowledge (ZK) continuations  which defines the transformation of a valid proof into another valid and unlinkable proof of the same statement through efficient operations. Essentially, this allows a prover to generate an initially costly proof and subsequently reuse it by simply rerandomizing it,  while maintaining unlinkability with other proofs. 
 	%This novel notion provides us with a practical tool for developing more efficient ring VRF constructions.
 	
 	\item We construct two distinct  ring VRF protocols. The first protocol is designed to be utilized with a non-interactive zero-knowledge (NIZK) proving system with our specific relations. The second protocol is more specialized, allowing instantiation with any zero-knowledge continuations. The latter offers an efficient solution for ring VRF applications that necessitate the generation of multiple signatures for the same ring. We show that both of our protocols are UC-secure.
 	
 	\item 	We construct a protocol called $ \SpecialG $  which  is a simple transformation of any Groth16 proof into a new proof by deploying the rerandomization idea of LegoSNARK ccGro16 \cite{LegoSNARK}. We show that $ \SpecialG $ is a zero-knowledge continuation, making it suitable for deployment in instantiating our second protocol. $ \SpecialG $'s reproving time is reduced to constant after running once a linear time proving algorithm.
 	 
  
 \end{itemize}
